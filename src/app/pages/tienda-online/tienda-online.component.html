<p-toast></p-toast>
<div class="grid">
  <div class="col-12">
    <div class="card">
      <h5>Seleccione los archivos </h5>
      <p-fileUpload name="myfile[]" customUpload="true" (uploadHandler)="onUpload($event)" multiple="multiple" accept=".xlsx" maxFileSize="1000000" chooseLabel="Agregar" uploadLabel="Cargar" cancelLabel="Cancelar">
      </p-fileUpload>
    </div>

    <div class="grid">
      <div class="col-12 xl:col-8">
        <div class="card">
          <h5>Tabla de datos</h5>
          <p-table #dt1 [value]="listTiendaOnline" dataKey="id" [rows]="5" [loading]="loading" [rowHover]="true" styleClass="p-datatable-gridlines" [paginator]="true" [globalFilterFields]="['usuario_cliente','usuario_vendedor','descripcion','fecha_transaccion']"
            currentPageReportTemplate="Mostrando {first} de {last} de {totalRecords} entradas" [showCurrentPageReport]="true" responsiveLayout="scroll">
            <ng-template pTemplate="caption">
              <div class="flex justify-content-between flex-column sm:flex-row">
                <button pButton label="Borrar filtros" class="p-button-outlined mb-2" icon="pi pi-filter-slash" (click)="clear(dt1)"></button>
                <span class="p-input-icon-left mb-2">
                            <i class="pi pi-search"></i>
                            <input pInputText type="text" #filter (input)="dt1.filterGlobal($event.target.value, 'contains')" placeholder="Buscar" class="w-full"/>
                        </span>
              </div>
            </ng-template>
            <ng-template pTemplate="header">
              <tr>
                <th>
                  <div class="flex justify-content-between align-items-center">
                    Cliente
                    <p-columnFilter type="text" field="usuario_cliente" display="menu" placeholder="Buscar por nombre"></p-columnFilter>
                  </div>
                </th>
                <th>
                  <div class="flex justify-content-between align-items-center">
                    Vendedor
                    <p-columnFilter type="text" field="usuario_vendedor" display="menu" placeholder="Search by country"></p-columnFilter>
                  </div>
                </th>
                <th>
                  <div class="flex justify-content-between align-items-center">
                    Descripción
                    <p-columnFilter type="text" field="descripcion" display="menu" placeholder="Search by country"></p-columnFilter>
                  </div>
                </th>
                <th>
                  <div class="flex justify-content-between align-items-center">
                    Fecha transacción
                  </div>
                </th>
                <th>
                  <div class="flex justify-content-between align-items-center">
                    Hora transacción
                  </div>
                </th>
                <th>
                  <div class="flex justify-content-between align-items-center">
                    Saldo
                  </div>
                </th>
                <th>
                  <div class="flex justify-content-between align-items-center">
                    Saldo adicional
                  </div>
                </th>
                <th style="width: 8rem">
                  <div class="flex justify-content-between align-items-center">
                    Saldo total
                  </div>
                </th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-data>
              <tr>
                <td style="min-width: 12rem;">
                  {{data.usuario_cliente}}
                </td>
                <td style="min-width: 12rem;">
                  {{data.usuario_vendedor}}
                </td>
                <td style="min-width: 14rem;">
                  {{data.descripcion}}
                </td>
                <td style="min-width: 10rem;">
                  {{data.fecha_transaccion.split('T')[0]}}
                </td>
                <td style="min-width: 10rem;">
                  {{data.fecha_transaccion.split('T')[1]}}
                </td>
                <td style="min-width: 10rem;">
                  {{data.saldo | currency:'$':'symbol'}}
                </td>
                <td style="min-width: 12rem;">
                  {{data.saldo_adicional | currency:'$':'symbol'}}
                </td>
                <td style="min-width: 12rem; ">
                  {{data.saldo_total | currency:'$':'symbol'}}
                </td>
              </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
              <tr>
                <td colspan="8">Sin registros</td>
              </tr>
            </ng-template>
            <ng-template pTemplate="loadingbody">
              <tr>
                <td colspan="8">Cargando información, por favor espere</td>
              </tr>
            </ng-template>
          </p-table>
        </div>
      </div>

      <div class="col-12 xl:col-4">
        <div class="card">
          <h5>Ventas por producto</h5>
          <p-table #dt2 [value]="listProductosMasVendidos" [rows]="13" [paginator]="true" responsiveLayout="scroll">
            <ng-template pTemplate="header">
              <tr>
                <th>
                  <div class="flex justify-content-between align-items-center">
                    Producto
                  </div>
                </th>
                <th pSortableColumn="cantidad">
                  <div class="">
                    Cantidad
                    <p-sortIcon field="cantidad"></p-sortIcon>
                  </div>
                </th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-data>
              <tr>
                <td style="min-width: 12rem;">
                  {{data.nombre_producto}}
                </td>
                <td style="min-width: 12rem;">
                  {{data.cantidad}}
                </td>
              </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
              <tr>
                <td colspan="8">Sin registros</td>
              </tr>
            </ng-template>
            <ng-template pTemplate="loadingbody">
              <tr>
                <td colspan="8">Cargando información, por favor espere</td>
              </tr>
            </ng-template>
          </p-table>
        </div>
      </div>
    </div>

    <div class="grid">
      <div class="col-12 xl:col-6">
        <div class="card">
          <h5>Compras por persona</h5>
          <p-table #dt3 [value]="listComprasPorPersona" [rows]="10" [paginator]="true" responsiveLayout="scroll" [globalFilterFields]="['nombre_persona','nombre_producto']">
            <ng-template pTemplate="caption">
              <div class="flex justify-content-between flex-column sm:flex-row">
                <button pButton label="Borrar filtros" class="p-button-outlined mb-2" icon="pi pi-filter-slash" (click)="clear(dt3)"></button>
                <span class="p-input-icon-left mb-2">
                              <i class="pi pi-search"></i>
                              <input pInputText type="text" #filter2 (input)="dt3.filterGlobal($event.target.value, 'contains')" placeholder="Buscar" class="w-full"/>
                          </span>
              </div>
            </ng-template>
            <ng-template pTemplate="header">
              <tr>
                <th pSortableColumn="nombre_persona">
                  <div class="flex justify-content-between align-items-center">
                    Persona
                    <p-sortIcon field="nombre_persona"></p-sortIcon>
                  </div>
                </th>
                <th pSortableColumn="nombre_producto">
                  <div class="flex justify-content-between align-items-center">
                    Producto
                    <p-sortIcon field="nombre_producto"></p-sortIcon>
                  </div>
                </th>
                <th pSortableColumn="cantidad_ventas">
                  <div class="flex justify-content-between align-items-center">
                    Cantidad Ventas
                    <p-sortIcon field="cantidad_ventas"></p-sortIcon>
                  </div>
                </th>
                <th pSortableColumn="total_vendido">
                  <div class="flex justify-content-between align-items-center">
                    Cantidad Dinero
                    <p-sortIcon field="total_vendido"></p-sortIcon>
                  </div>
                </th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-data>
              <tr>
                <td style="min-width: 12rem;">
                  {{data.nombre_persona}}
                </td>
                <td style="min-width: 12rem;">
                  {{data.nombre_producto}}
                </td>
                <td style="min-width: 12rem;">
                  {{data.cantidad_ventas}}
                </td>
                <td style="min-width: 12rem;">
                  {{data.total_vendido|currency:'$'}}
                </td>
              </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
              <tr>
                <td colspan="4">Sin registros</td>
              </tr>
            </ng-template>
            <ng-template pTemplate="loadingbody">
              <tr>
                <td colspan="4">Cargando información, por favor espere</td>
              </tr>
            </ng-template>
          </p-table>
        </div>

      </div>
      <div class="col-12 xl:col-6">
        <div class="card">
          <h5>Bar Chart</h5>
          <p-chart type="bar" [data]="barData" [options]="barOptions"></p-chart>
        </div>
      </div>
    </div>

  </div>

</div>
